Philippines military jets fired rockets at militant positions on Saturday as soldiers fought to wrest control of a southern city from gunmen linked to the Islamic State group, witnesses said.

Civilians waved flags from their windows to show they are not combatants.

The city of Marawi, home to some 200,000 people, has been under siege by IS-linked militants since a failed raid on Tuesday night on a suspected hideout of Isnilon Hapilon, who is on Washington’s list of most-wanted terrorists.

(Bullit Marquez/AP)

Hapilon got away and fighters loyal to him took over parts of the city, burning buildings and seizing about a dozen hostages, including a priest. Their condition was not known.

At least 44 people have died in the fighting, including 31 militants and 11 soldiers, officials said. It was not clear whether civilians were among the dead.

The violence prompted President Rodrigo Duterte on Tuesday to declare 60 days of martial law in the southern Philippines, where a Muslim rebellion has raged for decades. But the recent violence has raised fears that extremism could be growing as smaller militant groups unify and align themselves with the ideology of IS.

Although Hapilon and other groups in the southern Philippines have pledged allegiance to IS, there is no clear sign of significant, material ties.

(Bullit Marquez/AP)

Thousands of civilians have been fleeing.

“I saw two jets swoop down and fire at rebel positions repeatedly,” security guard Alexander Mangundatu told the Associated Press in Marawi as a plume of black smoke billowed in the distance.

“I pity the civilians and the women who were near the targeted area. They’re getting caught in the conflict and I hope this ends soon.”

Military spokesman Brigadier General Restituto Padilla said government forces are working to “clear the city of all remnants of this group”.

He said some civilians had refused to evacuate because they want to guard their homes, slowing down the government operations.

“But that’s fine as long as civilians are not hurt,” he added.

On Friday, Mr Duterte ordered his troops to crush the militants, warning that the country is at a grave risk of “contamination” by IS.

He told soldiers in Iligan, a city near Marawi, that he had long feared that “contamination by Isis” loomed in the country’s future, using the acronym for IS.

“You can say that Isis is here already,” he said.