Black smoke billows from burning houses after the bombing of militant positions in Marawi

Islamist militants occupying parts of a southern Philippine city used a water route to bring in ammunition and evacuate wounded fighters, helping them withstand a five-week military offensive, the army said Tuesday.

The extremists fighting under the black banner of the Islamic State (IS) group have remained holed up in pockets of Marawi, weathering daily air and artillery bombardment and deadly urban street battles.

Military spokesman Lieutenant Colonel Jo-ar Herrera said the route was discovered following the arrest of a man who used a boat to smuggle ammunition into the battle zone and ferry wounded militants out.

The military was able to cut off the "logistical and medical highway" across Lake Lanao, he said, adding that boat patrols on the lake have been bolstered.

"We found out that this man... is the one facilitating the entry of ammunition. He is also the person bringing wounded fighters from the main battle area toward the south of Lanao Lake," Herrera told reporters.

"This is good news because we have now blocked this highway."

Marawi, the most important Muslim city in the mainly Catholic Philippines, is located on the shores of Lake Lanao on Mindanao island.

Hundreds of militants attacked the city on May 23.

The government described the attack as a rebellion aimed at setting up an IS province in the area -- part of what it said was an attempt to carve out a caliphate in Southeast Asia.

President Rodrigo Duterte declared martial law across Mindanao to quell the rebellion. But five weeks of fighting have failed to fully drive out the militants, who have been joined by fighters from Indonesia, Malaysia and as far away as Chechnya.

Nearly 400 people have been killed, including 290 militants and 70 troops, according to official figures. Most of Marawi's 200,000 residents have fled and much of the city is in ruins.

Herrera said the military was still trying to confirm reports that a key leader of the attack, veteran Filipino militant Isnilon Hapilon, had been able to escape the military encirclement.

Up to 120 militants remain holed up in parts of four districts of Marawi, the military said, as air strikes and artillery shelling continued Tuesday.

The militants are also holding around 100 hostages, including a Roman Catholic priest they abducted early in the siege.

- Fight to the death -

Defence Secretary Delfin Lorenzana said Tuesday the military was under pressure to crush the militants before Duterte delivers his annual state-of-the-nation address on July 24.

"There's a bit of pressure because if Marawi is still there and there is still killing, it doesn't look good for the state-of-the nation address by the president," Lorenzana said on radio station DZRH.

But he said it looked like the militants "are going to fight to the death".

"We have a bullhorn, we tell them 'come down and surrender, you cannot win' but they still continue to fight," he added.

"The other day they killed one of our soldiers so it means they are still strong so our operation will continue."

Presidential spokesman Ernesto Abella on Tuesday disassociated the government with talks between local Muslim religious teachers and the militants held on Sunday for the release of hostages.

The talks were "not sanctioned by government, the military and our political leaders," he said.

"Any demands made inside therefore hold no basis."